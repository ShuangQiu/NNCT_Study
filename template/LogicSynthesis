# use dc_shell
##############
# db: Target Library
# target: vhdl file
# name: vhdf name
# output_vg: vg output file
# output_spf: spf output file

set link_library $db
set target_library $db
read_vhdl $target
current_design $name
set test_default_scan_style multiplexed_flip_flop
link
create_clock  -p 50 clock
set_scan_configuration -chain_count 1
set_scan_configuration -create_dedicated_scan_out_ports true
set_scan_configuration -style multiplexed_flip_flop
set_scan_configuration -internal_clocks single
create_test_protocol -infer_clock -infer_async
dft_drc -verbose
compile -scan -ungroup
insert_dft
remove_unconnected_ports [find -hierarchy cell {"*"}]
change_names -rules verilog -hierarchy
write -hi -format verilog -output $output_vg
write_test_protocol -o $output_spf
report_reference
exit
